<div class="quiz-wrapper" *ngIf="questions.length > 0; else loading">
  <!-- LEFT SIDEBAR -->

  
  <app-left-sidebar></app-left-sidebar>

   <!-- Saving Spinner -->
   <div *ngIf="savingInProgress" class="saving-overlay">
    <div class="spinner"></div>
    <p>Saving your results... Please wait ⏳</p>
  </div>

  <div class="example-section" *ngIf="showExample">
    <h3>📘 Learn with an Example</h3>
    <div [innerHTML]="exampleHtml"></div>
    <button (click)="showExample = false">Start Quiz</button>
  </div>
  
  
  <!-- MAIN CONTENT -->
  <div class="quiz-main-card">
    <app-paper-download
    [user_id]="user_id"
    [username]="username"
    [operation]="currentOperation"
    [level]="level"> </app-paper-download>
  
    <!-- <button (click)="goHome()">🏠 Go to Home</button>-->
  <div class="button-group">
    <button (click)="printQuestions()" class="print-button">🖨️ Print </button>
    <button class="print-button" (click)="goBack()" >🔙 Go Back</button>
    </div>
    <div class="quiz-header">
      <h2 class="quiz-title addition"> Taking a Challenge in 
        {{ currentOperation | titlecase }} –
        {{
          currentOperation === 'sudoku'
            ? (level === 0 ? 'Easy' : level === 1 ? 'Medium' : 'Difficult')
            : 'Level ' + level
        }}
      </h2>
    </div>

    <div *ngIf="questions[currentQIndex]" class="question-row">
      <div class="character-container" (click)="readQuestionAloud()">
        <img src="assets/images/bird1.gif" alt="Bird Reader" [class.animate]="isReading" />
      </div>
        
          {{ questions[currentQIndex].question.split('=')[0] }} =
          <input
            type="text"
            [(ngModel)]="answerInput"
            class="answer-input"
            (keyup.enter)="submitAnswer()"
            [disabled]="quizCompleted"
            autocomplete="off"
            placeholder="?" />
        
          <button class="print-button" *ngIf="!quizCompleted" (click)="submitAnswer()">Submit</button>
          <button class="try-again" *ngIf="quizCompleted && score < questions.length" (click)="restartQuiz()">🔁 Try Again</button>
      </div>

    <div class="feedback" *ngIf="feedbackMessage">
      <p>{{ feedbackMessage }}</p>
    </div>

    
    <div class="practice-done-box">
      <div class="hover-options">
        
        <div class="hover-item" (click)="goToLearn()">
          <img src="assets/images/greenPuzzle.png" class="puzzle-icon" />
          <div class="hover-text">Not sure? Want to learn with example?</div>
          <div class="example-box">
            <p><strong>Example:</strong> 300 + 500 = 800</p>
            <p>Arrange as:</p>
            <pre>300\n+500</pre>
          </div>
        </div>
    
        <div class="hover-item" (click)="takeChallenge()">
          <img src="assets/images/bluePuzzle.png" class="puzzle-icon" />
          <div class="hover-text">Ready? Try the challenge now!</div>
          <div class="example-box">
            <p>Challenge yourself with 5 random questions from this level.</p>
          </div>
        </div>
    
      </div>
    </div>
  </div>

  <!-- RIGHT SIDEBAR -->
   <div class="right-sidebar ">
  <app-right-sidebar *ngIf="username"
    class="sidebar right"
    [username]="username"
    [score]="score"
    [currentQIndex]="currentQIndex"
    [totalQuestions]="questions.length"
    [elapsedTime]="elapsedTime">
  </app-right-sidebar>
</div>
</div>
  <!-- LOADING TEMPLATE -->
<ng-template #loading>
  <p>⏳ Loading questions...</p>
</ng-template>
