
<div class="quiz-wrapper" *ngIf="questions.length > 0">
  <!-- LEFT SIDEBAR -->
    <app-left-sidebar></app-left-sidebar>

  <!-- MAIN QUIZ CONTENT -->
  <div class="quiz-main-card">
    <app-paper-download></app-paper-download>
    <div class="button-group">
      <button (click)="printQuestions()" class="button print-button">üñ®Ô∏è Print</button>
      <button (click)="goBack()" class="button print-button">üîô Go Back</button>
    </div>
    
    <div class="quiz-header">
      <h2 class="quiz-title fmc">
        FMC ‚Äì Level {{ level }}
      </h2>
    </div>

    <!-- Question Section -->
    <div *ngIf="questions[currentQIndex]" class="question-row">
      <div class="character-container" (click)="readQuestionAloud()">
        <img src="assets/images/bird1.gif" alt="Bird Reader" [class.animate]="isReading" />
      </div>
      <div class="question-container">
        <p>
          {{ questions[currentQIndex]?.question }}
        </p>
        <div class="button-group">

        <label>
          Your answer:
          <input
            type="text"
            [(ngModel)]="userAnswer"
            (keydown.enter)="submitAnswer()"
            placeholder="?" />
          </label>


          <button *ngIf="!quizCompleted" (click)="submitAnswer()">Submit</button>

          <button class="try-again" *ngIf="quizCompleted && score < questions.length" (click)="restartQuiz()">üîÅ Try Again</button>
        </div>

      </div>
    </div>

    <!-- Feedback -->
    <div class="feedback" *ngIf="feedbackMessage">
      <p>{{ feedbackMessage }}</p>
    </div>
    
    <!-- Retry -->
    <div *ngIf="isFinished">
      <h3>You scored {{ score }}/{{ questions.length }}</h3>
      <button (click)="tryAgain()">Try Again</button>
      <button (click)="reviewAnswers()">Review Your Answers</button>
    </div>
    <div class="practice-done-box">
      <div class="hover-options">
        
        <div class="hover-item" (click)="goToLearn()">
          <img src="assets/images/greenPuzzle.png" class="puzzle-icon" />
          <div class="hover-text">Not sure? Want to learn with example?</div>
          <div class="example-box">
            <p><strong>Example:</strong> 300 + 500 = 800</p>
            <p>Arrange as:</p>
            <pre>300\n+500</pre>
          </div>
        </div>
    
        <div class="hover-item" (click)="takeChallenge()">
          <img src="assets/images/redPuzzle.png" class="puzzle-icon" />
          <div class="hover-text">Ready? Try the challenge now!</div>
          <div class="example-box">
            <p>Challenge yourself with 5 random questions from this level.</p>
          </div>
        </div>
    
      </div>
    </div>
  </div>

  <!-- RIGHT SIDEBAR -->
  <div class="right-sidebar">
    <app-right-sidebar *ngIf="username"
      [username]="username"
      [score]="score"
      [currentQIndex]="currentQIndex"
      [totalQuestions]="questions.length"
      [elapsedTime]="elapsedTime">
    </app-right-sidebar>
  </div>
</div>

<!-- Fallback -->
<div *ngIf="questions.length === 0">
  <p>Loading questions...</p>
</div>

