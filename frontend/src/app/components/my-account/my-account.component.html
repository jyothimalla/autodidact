<div class="account-page-container">
  <div class="account-wrapper" *ngIf="username">
    <h2>
      Welcome, {{ username }}
      <span class="title-badge">{{ awardedName || 'No Title Yet' }}</span>
    </h2>

    <button class="back-btn" (click)="goToOperations()">â¬…ï¸ Back to Operations</button>
    <button class="edit-btn" (click)="isEditing = true">âœï¸ Edit Profile</button>

    <div *ngIf="isEditing" class="edit-form">
      <label>Username:</label>
      <input [(ngModel)]="editUsername" type="text" />

      <label>Email:</label>
      <input [(ngModel)]="editEmail" type="email" />

      <label>New Password:</label>
      <input [(ngModel)]="editPassword" type="password" />

      <button (click)="saveChanges()">ğŸ’¾ Save</button>
      <button (click)="cancelEdit()">âŒ Cancel</button>
    </div>

    <div class="stars-row">
      <label>Your Ninja Stars:</label>
      <span class="stars">
        <ng-container *ngFor="let i of [].constructor(5)">
          <span [class.filled]="i < ninjaStars">â˜…</span>
        </ng-container>
      </span>
    </div>

    <div class="year-row">
      <label for="studentYear">Current Year:</label>
      <select id="studentYear" [value]="studentYear" (change)="onStudentYearChange($event)">
        <option *ngFor="let y of [1,2,3,4,5,6,7,8,9,10,11,12,13]" [value]="y">Year {{ y }}</option>
      </select>
      <span class="plan-note">Current plan: Year {{ studentYear }}</span>
    </div>

    <h3>Your Attempts</h3>
    <div *ngIf="attempts.length > 0; else noAttempts">
      <div class="attempt-card" *ngFor="let attempt of attempts">
        <div class="attempt-header">
          <strong>{{ attempt.operation }}</strong> - Level {{ attempt.level }}
          <span class="date">{{ attempt.date }}</span>
        </div>
        <div class="progress-bar-container">
          <div class="progress-bar" [style.width.%]="attempt.score * 10"></div>
        </div>
        <p>Score: {{ attempt.score }}/10</p>
      </div>
    </div>

    <ng-template #noAttempts>
      <p>You havenâ€™t attempted any quizzes yet. Start now!</p>
    </ng-template>

    <button class="delete-btn" (click)="deleteAccount()">âŒ Delete Account</button>
  </div>
</div>
