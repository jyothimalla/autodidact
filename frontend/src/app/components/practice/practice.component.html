<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     FORM STATE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="practice-page" *ngIf="state === 'form'">

  <div class="page-header">
    <button class="btn-back" (click)="goBack()">â† Back to Home</button>
    <h1>Practice Papers</h1>
    <p>Choose a subject and topic, generate a paper, then answer it online</p>
  </div>

  <!-- â”€â”€ Subject Quick-Start Cards â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div class="subject-hub">
    <h2>What would you like to practice?</h2>
    <div class="subject-cards">
      <div *ngFor="let subj of featuredSubjects"
           class="subject-card"
           [class.selected]="selectedSubject === subj.id"
           (click)="quickStartSubject(subj.id)">
        <div class="subj-icon">{{ subj.icon }}</div>
        <div class="subj-name">{{ subj.name }}</div>
        <div class="subj-desc">{{ subj.description }}</div>
      </div>
    </div>
  </div>

  <!-- â”€â”€ Generate New Paper â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div class="generation-form" id="generation-form">
    <h2>Generate a Paper</h2>

    <div class="form-grid">
      <div class="form-group">
        <label for="subject">Subject *</label>
        <select id="subject" [(ngModel)]="selectedSubject" (change)="onSubjectChange()" class="form-control">
          <option value="">-- Select Subject --</option>
          <option *ngFor="let subject of subjects" [value]="subject.id">
            {{ subject.icon }} {{ subject.name }}
          </option>
        </select>
      </div>

      <div class="form-group">
        <label for="topic">Topic *</label>
        <select id="topic" [(ngModel)]="selectedTopic" [disabled]="!selectedSubject" class="form-control">
          <option value="">-- Select Topic --</option>
          <option *ngFor="let topic of availableTopics"
                  [value]="topic.id"
                  [disabled]="!topic.supported">
            {{ topic.name }}{{ !topic.supported ? ' (Coming Soon)' : '' }}
          </option>
        </select>
      </div>

      <div class="form-group">
        <label for="questions">Questions *</label>
        <select id="questions" [(ngModel)]="numQuestions" (change)="onQuestionCountChange()" class="form-control">
          <option *ngFor="let num of questionOptions" [value]="num">{{ num }} Questions</option>
        </select>
      </div>

      <div class="form-group">
        <label for="difficulty">Difficulty *</label>
        <select id="difficulty" [(ngModel)]="difficulty" class="form-control">
          <option *ngFor="let diff of difficultyOptions" [value]="diff">{{ diff }}</option>
        </select>
      </div>
    </div>

    <button
      class="btn-generate"
      (click)="generatePaper()"
      [disabled]="!canGeneratePaper() || generating">
      {{ generating ? 'Generating...' : 'âœ¦ Generate & Answer Online' }}
    </button>
  </div>

  <!-- â”€â”€ My Practice History by Subject â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div class="practice-history" *ngIf="hasAnyPapers">
    <h2>My Practice History</h2>

    <div *ngFor="let subj of featuredSubjects">
      <div class="subject-section" *ngIf="getSubjectPapers(subj.id).length > 0">
        <div class="subject-section-header">
          <span class="subj-hdr-icon">{{ subj.icon }}</span>
          <span class="subj-hdr-name">{{ subj.name }}</span>
          <span class="subj-hdr-count">{{ getSubjectPapers(subj.id).length }} paper(s)</span>
        </div>

        <div class="papers-list">
          <div *ngFor="let paper of getSubjectPapers(subj.id)" class="paper-row">
            <div class="paper-info">
              <span class="paper-topic">{{ paper.topic_name }}</span>
              <span class="paper-meta">
                {{ paper.num_questions }} Qs Â· {{ paper.difficulty }} Â· {{ formatDate(paper.created_at) }}
              </span>
            </div>

            <div class="paper-result" *ngIf="paper.status === 'submitted' && paper.percentage != null">
              <span class="score-badge" [class.pass]="paper.percentage! >= 60">
                {{ paper.percentage }}%
              </span>
            </div>
            <div class="paper-status-badge" *ngIf="paper.status !== 'submitted'">
              <span class="status-chip">{{ paper.status }}</span>
            </div>

            <div class="paper-actions">
              <button class="btn-action btn-online" (click)="attemptOnline(paper.paper_id)">
                âœï¸ Answer Online
              </button>
              <button class="btn-action btn-offline" (click)="attemptOffline(paper.paper_id)">
                ğŸ“¥ Attempt Offline
              </button>
              <button class="btn-action btn-upload" (click)="uploadAnswers(paper.paper_id)">
                ğŸ“· Upload Photo
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Papers from other subjects (Computers, Science, etc.) -->
    <div class="subject-section" *ngIf="otherSubjectPapers.length > 0">
      <div class="subject-section-header">
        <span class="subj-hdr-icon">ğŸ“„</span>
        <span class="subj-hdr-name">Other Subjects</span>
        <span class="subj-hdr-count">{{ otherSubjectPapers.length }} paper(s)</span>
      </div>
      <div class="papers-list">
        <div *ngFor="let paper of otherSubjectPapers" class="paper-row">
          <div class="paper-info">
            <span class="paper-topic">{{ getSubjectIcon(paper.subject_id) }} {{ paper.topic_name }}</span>
            <span class="paper-meta">{{ paper.num_questions }} Qs Â· {{ paper.difficulty }} Â· {{ formatDate(paper.created_at) }}</span>
          </div>
          <div class="paper-actions">
            <button class="btn-action btn-online" (click)="attemptOnline(paper.paper_id)">âœï¸ Answer Online</button>
            <button class="btn-action btn-offline" (click)="attemptOffline(paper.paper_id)">ğŸ“¥ Attempt Offline</button>
            <button class="btn-action btn-upload" (click)="uploadAnswers(paper.paper_id)">ğŸ“· Upload Photo</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Empty state -->
  <div class="empty-state" *ngIf="!hasAnyPapers">
    <div class="empty-icon">ğŸ“</div>
    <h3>No Papers Yet</h3>
    <p>Pick a subject above and generate your first practice paper!</p>
  </div>

</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     PAPER READY STATE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section class="paper-ready-page" *ngIf="state === 'paper-ready'">
  <div class="ready-badge">âœ… Paper Ready!</div>
  <h2>{{ readyPaperName }}</h2>
  <p class="paper-id-display">Paper ID: <code>{{ readyPaperId }}</code></p>

  <button class="btn-start-online" (click)="attemptOnline(readyPaperId)">
    âœï¸ Answer Questions Now
  </button>

  <div class="or-divider">â€” or â€”</div>

  <button class="btn-offline-ready" (click)="attemptOffline(readyPaperId)">
    ğŸ“¥ Attempt Offline (Download PDF)
  </button>

  <div class="or-divider">â€” or â€”</div>

  <button class="btn-upload-ready" (click)="uploadAnswers(readyPaperId)">
    ğŸ“· Upload a Photo of Your Answers
  </button>

  <button class="btn-back-to-form" (click)="backToForm()">â† Back to Practice</button>
</section>
